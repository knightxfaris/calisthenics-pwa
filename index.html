<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Calisthenics Tracker</title>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.9.0/firebase-app.js";
    import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.9.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBGDV3F8YZ6-bqtkx4AMbEt-Sy8PYlPkUU",
      authDomain: "calisthenics-tracker-45570.firebaseapp.com",
      projectId: "calisthenics-tracker-45570",
      storageBucket: "calisthenics-tracker-45570.firebasestorage.app",
      messagingSenderId: "330168228790",
      appId: "1:330168228790:web:c24cfe79e669e6237dbf17",
      measurementId: "G-Y3KN5D0DCH"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    window.saveToCloud = async function(user, date, key, value) {
      const docRef = doc(db, "users", user);
      const docSnap = await getDoc(docRef);
      let data = docSnap.exists() ? docSnap.data() : {};
      if (!data[date]) data[date] = {};
      data[date][key] = value;
      await setDoc(docRef, data);
    }

    window.loadFromCloud = async function(user, date, key) {
      const docRef = doc(db, "users", user);
      const docSnap = await getDoc(docRef);
      if (docSnap.exists() && docSnap.data()[date]) {
        return docSnap.data()[date][key] || "";
      }
      return "";
    }
  </script>
</head>
<body>
  <h2>Calisthenics Tracker - Welcome Faris</h2>
  <div id="status"></div>
  <script>
    const user = "Faris";
    const today = new Date().toISOString().split("T")[0];
    const key = "squats";
    const value = "3x15";

    saveToCloud(user, today, key, value).then(() => {
      document.getElementById("status").innerText = "Saved to Firebase âœ…";
    });
  </script>
</body>
</html>
